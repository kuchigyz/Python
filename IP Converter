while True:
  ipString = input('IP Adress:   ')
  if ipString == '':
    continue
  elif ipString == 'exit' or ipString == 'quit':
    break  
  ipString = ipString.split('.')
  maskString = input('Subnet Mask: ')
  if maskString == '':
    continue
  elif maskString == 'exit' or maskString == 'quit':
    break  
  maskString = maskString.split('.')

  ip = [int(i) for i in ipString]
  mask = [int(i) for i in maskString]

  if ip[0] < 128:
    ipClass = 1
  elif ip[0] < 192:
    ipClass = 2  
  else:
    ipClass = 3

  #Functions
  def binToList(b):
    return [int(d) for d in bin((1<<8)+b)[-8:]]
  def listToStr(l):
    return '.'.join([str(i) for i in l])

  a = binToList(ip[ipClass])
  b = binToList(mask[ipClass])
  #Number of Subnet Bits
  subnetBits = 0
  for i in range(len(b)-1,-1,-1):
    if b[i] == 1:
        subnetBits = i + 1
        break
  print('Subnet Bits:', subnetBits)
  print('Subnets:    ', 2 ** subnetBits)

  #Number of Host Bits
  if ipClass == 1:
    hostBits = 3 * 8 - subnetBits
  if ipClass == 2:
    hostBits = 2 * 8 - subnetBits
  if ipClass == 3:
    hostBits = 8 - subnetBits
  print('Host Bits:  ', hostBits)
  
  #Number of possible Hosts
  print('Hosts:      ', 2 ** hostBits - 2)

  #Network Adress
  networkAdress = ip.copy()
  networkAdress[ipClass] = ip[ipClass] & mask[ipClass]
  c = binToList(networkAdress[ipClass])
  if ipClass == 1: 
    networkAdress[ipClass + 1] = 0
    networkAdress[ipClass + 2] = 0
  if ipClass == 2:
    networkAdress[ipClass + 1] = 0

  #First Host Adress
  firstHostAdress = networkAdress.copy()
  firstHostAdress[3] += 1

  #Broadcast Adress
  broadcastAdress = networkAdress.copy()
  broadcastAdress[ipClass] = binToList(broadcastAdress[ipClass])
  for i in range(subnetBits, 8):
    broadcastAdress[ipClass][i] = 1  
  broadcastAdress[ipClass] = int(''.join(map(str, broadcastAdress[ipClass])), 2)
  if ipClass == 1:
    broadcastAdress[2] = 255
    broadcastAdress[3] = 255
  if ipClass == 2:
    broadcastAdress[3] = 255  

  #Last Host Adress
  lastHostAdress = broadcastAdress.copy()
  lastHostAdress[3] -= 1

  c = binToList(networkAdress[ipClass])
  #Print Adress
  networkAdress = listToStr(networkAdress)
  print('Network:    ', networkAdress)
  firstHostAdress = listToStr(firstHostAdress)
  print('First host: ', firstHostAdress)
  lastHostAdress = listToStr(lastHostAdress)
  print('Last host:  ', lastHostAdress)
  broadcastAdress = listToStr(broadcastAdress)
  print('Broadcast:  ', broadcastAdress)
  print('\n Bitwise Multiplication\n{}\n{}\n{}\n'.format(a, b, c))
